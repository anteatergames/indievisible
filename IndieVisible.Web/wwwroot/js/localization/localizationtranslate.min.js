var LOCALIZATIONCOMMON=function(){"use strict";function r(){n.controlsidebar=".control-sidebar";n.canInteract="#caninteract";n.urls="#urls";n.container="#featurecontainer";n.btnDelete=".btnDeleteTranslationProject"}function u(){t.controlsidebar=$(n.controlsidebar);t.container=$(n.container);t.urls=$(n.urls)}function f(){r();u();i=t.container.find(n.canInteract).val();e();c()}function e(){o();CONTENTACTIONS.BindShareContent();MAINMODULE.Common.BindPopOvers()}function o(){t.container.on("click",n.btnDelete,function(n){n.preventDefault();var t=$(this);return i&&h(t),!1})}function h(n,t){var r=n.data("url"),i=MAINMODULE.Common.GetDeleteMessages(n);ALERTSYSTEM.ShowConfirmMessage(i.confirmationTitle,i.msg,i.confirmationButtonText,i.cancelButtonText,function(){$.ajax({url:r,type:"DELETE"}).done(function(n){n.success?(t&&t(n),MAINMODULE.Common.HandleSuccessDefault(n)):ALERTSYSTEM.ShowWarningMessage(n.message)})})}function c(){MAINMODULE.Layout.SetStickyElement("#divTranslationSelector",50,"#divTranslationSelector")}var n={},t={},i=!1;return{Init:f}}(),LOCALIZATIONTRANSLATE,CONTENTACTIONS;$(function(){LOCALIZATIONCOMMON.Init()});LOCALIZATIONTRANSLATE=function(){"use strict";function c(){n.controlsidebar=".control-sidebar";n.canInteract="#caninteract";n.urls="#urls";n.container="#featurecontainer";n.form="#frmTranslationSave";n.btnSave="#btnSaveTranslation";n.ddlLanguage="#Language";n.btnFilter=".btn-filter";n.entry=".translation-entry";n.entryInput=":input.entry-input";n.entryActions=".translation-entry-actions";n.entrySave=n.entryActions+" .entry-save";n.entryCancel=n.entryActions+" .entry-cancel";n.entryAuthors=".entry-authors";n.entryAuthorTemplate=".entry-author.template";n.entryAuthorButton=".entry-author-btn";n.divUploadTerms="div#divUploadTerms";n.btnUploadTerms="#btnUploadTerms";n.btnSaveTerms="#btnSaveTerms";n.ddlColumn=".ddlcolumn";n.id="#Id";n.currentUserHelped="#CurrentUserHelped";n.currentUserIsOwner="#CurrentUserIsOwner";n.termItem=".translation-term";n.changedCounter="#changedtranslationscounter";n.btnSaveTranslationChanges="#btnSaveTranslationChanges";n.divNoItems="#divNoItems"}function l(){t.currentUserHelped=$(n.currentUserHelped);t.currentUserIsOwner=$(n.currentUserIsOwner);t.controlsidebar=$(n.controlsidebar);t.container=$(n.container);t.urls=$(n.urls);t.container=$(n.container);t.ddlLanguage=$(n.ddlLanguage);t.entryAuthors=$(n.entryAuthors);t.changedCounter=$(n.changedCounter)}function a(){c();l();h=t.container.find(n.canInteract).val();v();rt();u(t.ddlLanguage)}function v(){p();y();w();d();k();b()}function y(){t.container.on("change",n.ddlLanguage,function(){var i=$(this);t.container.find(n.entryInput).val("");$(n.entryInput).data("originalval","");o();u(i)})}function p(){t.container.on("click",n.btnFilter,function(){var r=$(this),i=r.data("filter");i!=="Untranslated"&&u(t.ddlLanguage);var f=t.container.find(n.entryInput),e=i==="All"||i==="Translated",o=i==="All"||i==="Untranslated";f.each(function(t,i){var r=$(i),u=r.data("translated");u&&e||!u&&o?r.closest(n.entry).show():r.closest(n.entry).hide()})})}function w(){t.container.on("click",n.entrySave,function(u){var l;u.preventDefault();var a=$(this),o=a.closest(n.entry).find(n.entryInput),h=o.data("termid"),v=t.urls.data("urlEntrySave"),c=t.ddlLanguage.val(),y=t.currentUserHelped.val(),p=t.currentUserIsOwner.val();r!==!0&&c&&o.val().length>0&&(r=!0,l={currentUserHelped:y,currentUserIsOwner:p,termId:h,language:c,value:o.val()},$.post(v,l).done(function(n){if(n.success===!0?(t.currentUserHelped.val("True"),nt(n.value.termId,n.value.userId),f(n.value),e(),s(i,h)):ALERTSYSTEM.ShowWarningMessage("An error occurred! Check the console!"),n.message){var u=MAINMODULE.Common.HandlePointsEarned(n);u||ALERTSYSTEM.Toastr.ShowWarning(n.message)}r=!1}))})}function b(){t.container.on("click",n.btnSaveTranslationChanges,function(){var h=t.urls.data("urlEntriesSave"),f=t.ddlLanguage.val(),u,r,e,s;if(f){for(u=[],r=0;r<i.length;r++)e=$(n.entryInput+"[data-termid="+i[r]+"]"),s={termId:i[r],value:e.val()},u.push(s);$.post(h,{language:f,entries:u}).done(function(t){var r,u;if(t.success===!0){for(r=0;r<i.length;r++)u=$(n.entryInput+"[data-termid="+i[r]+"]"),u.data("changed",!1),u.data("originalval",u.val());i=[];o();t.message&&ALERTSYSTEM.Toastr.ShowWarning(t.message)}else ALERTSYSTEM.ShowWarningMessage("An error occurred! Check the console!")})}})}function k(){t.container.on("blur",n.entryInput,function(){var n=$(this),u=t.ddlLanguage.val(),f=n.data("originalval"),r=n.data("termid"),o=n.val(),h=f!==o;u&&(h?n.data("changed")!==!0&&(i.push(r),n.data("changed",!0),it()):n.data("changed")===!0&&(s(i,r),n.data("changed",!1),e()))})}function d(){t.container.on("click",n.entryAuthorButton,function(t){t.preventDefault();var i=$(this),r=i.closest(n.entry).find(n.entryInput),u=i.data("value");return r.val(u),!1})}function g(i,r){var f=$(n.entryAuthorTemplate).first().clone(),u=f.find("a"),e=t.urls.data("urlAvatar").replace(/xpto/g,r.userId);u.find("img").attr("data-src",e);u.attr("data-userid",r.userId);u.attr("title",r.authorName);u.attr("data-value",r.value);f.removeClass("template");f.appendTo(i)}function nt(i,r){var u=t.container.find(n.entryInput+"[data-termid="+i+"]"),f=u.closest(n.entry),e=f.find(n.entryAuthorButton+"[data-userId="+r+"]");e.parent().remove()}function u(n){var i=t.urls.data("urlEntriesGet"),r=n.val(),u={language:r};$.post(i,u).done(function(n){if(n.success===!0){tt();for(var t=0;t<n.value.length;t++)f(n.value[t])}else ALERTSYSTEM.ShowWarningMessage("An error occurred! Check the console!")})}function tt(){var i=t.container.find(n.entryInput);i.each(function(n,t){$(t).data("translated",!1)});$(n.entryAuthors).html("")}function f(i){var r=t.container.find(n.entryInput+"[data-termid="+i.termId+"]");r.val(i.value);r.data("originalval",i.value);r.data("translated",!0);g(r.closest(n.entry).find(n.entryAuthors),i)}function it(){var n=t.changedCounter.data("count");return n++,t.changedCounter.data("count",n),t.changedCounter.html(n),n}function e(){var n=t.changedCounter.data("count");return n--,n<0&&(n=0),t.changedCounter.data("count",n),t.changedCounter.html(n),n}function o(){t.changedCounter.data("count",0);t.changedCounter.html(0)}function s(n,t){const i=n.indexOf(t);n.splice(i,1)}function rt(){MAINMODULE.Layout.SetStickyElement("#divTranslationSelector",50,"#divTranslationSelector")}var r=!1,n={},t={},h=!1,i=[];return{Init:a}}();$(function(){LOCALIZATIONTRANSLATE.Init()});CONTENTACTIONS=function(){"use strict";function e(){o();s();h()}function o(){n.container=".content-wrapper";n.item=".box-content";n.btnShare=".btn-share";n.sharePopup=".share-popup";n.btnInteractionComment=".btn-interaction-comment";n.commentBox=".interaction-commentbox";n.commentTextArea=".commenttextarea";n.btnLike=".btn-interaction-like";n.btnInteractionShare=".btn-interaction-share";n.sharePopup=".share-popup";n.likeCounter=".like-count"}function s(){t.container=$(n.container)}function h(){c();l();a();v();y();i()}function c(){t.container.on("click",n.btnLike,function(){var t=$(this),i=t.closest(n.item).find(n.likeCounter),r=t.data("id");t.hasClass("like-liked")?b(r).done(function(n){k(n,i,t)}):p(r).done(function(n){w(n,i,t)})})}function l(){t.container.on("click",n.btnInteractionComment,function(){var t=$(this),i=t.closest(n.item).find(".box-commentsection"),r=t.closest(n.item).find(n.commentBox),u=t.closest(n.item).find(n.commentTextArea);i.is(":visible")?(i.addClass("d-none"),r.addClass("d-none")):(i.removeClass("d-none"),r.removeClass("d-none"),u.val("").focus())})}function a(){t.container.on("keyup","textarea.commentbox",function(t){var e=$(this);if((t.keyCode===10||t.keyCode===13)&&t.ctrlKey){var i=e.closest(n.commentBox).find(".commenttextarea"),s=i.data("url"),h=e.closest(n.item).find(".comment-count"),c=i.data("usercontentid"),o=i.val().replace(/\n/g,"<br>\n"),l=i.data("usercontenttype");o.length>0&&r(s,c,o,l).done(function(n){u(n,h,i)})}f(this)})}function v(){t.container.on("click",".btn-interaction-comment-send",function(){var f=$(this),t=f.closest(n.commentBox).find(".commenttextarea"),e=t.data("url"),o=t.closest(n.item),s=o.find(".comment-count"),h=t.data("usercontentid"),i=t.val().replace(/\n/g,"<br>\n"),c=t.data("usercontenttype");i.length>0&&r(e,h,i,c).done(function(n){u(n,s,t)})})}function y(){t.container.on("click",n.btnShare,function(t){var u;t.preventDefault();$(n.sharePopup).fadeOut();var i=$(this).prop("href"),f=$(this).data("title"),r=$(this).data("provider");return i=encodeURI(i),r==="facebook"?FB.ui({method:"share",href:i},function(){}):r==="reddit"?(i="https://www.reddit.com/submit?title="+f+"&url="+i,window.open(i)):r==="twitter"?(u=$(this).data("text"),i="https://www.twitter.com/intent/tweet?text="+u+" "+i,window.open(i)):console.log(r),!1})}function i(){$(n.btnInteractionShare).each(function(t,i){var r=$(i),u=r.data();if(u.target){$(r).off("click");$(r).on("click",function(){console.log("clickshare");var t=$(u.target),i=r.position();t.css("top",i.top-80);t.on("mouseleave",function(){setTimeout(function(){t.is(":visible")&&t.fadeOut()},500)});$(n.sharePopup).fadeOut();t.is(":visible")?t.fadeOut():t.fadeIn()})}})}function p(n){return $.post("/content/like",{targetId:n})}function w(n,t,i){n.success===!0&&($(t).text(n.value),i.addClass("text-blue"),i.addClass("like-liked"))}function b(n){return $.post("/content/unlike",{targetId:n})}function k(n,t,i){n.success===!0&&($(t).text(n.value),i.removeClass("text-blue"),i.removeClass("like-liked"))}function r(n,t,i,r){return(n===null||n===undefined||n.length===0)&&(n="/content/comment"),$.post(n,{UserContentId:t,Text:i,UserContentType:r})}function u(t,i,r){var f,e,u,o,s;t.success===!0&&(f=r.closest(n.commentBox),e=r.val().replace(/\n/g,"<br>\n"),r.val(""),$(i).text(t.value),CONTENTACTIONS.AutosizeTextArea(r[0]),u=$(".box-comment-template").first().clone(),o=f.find("img").attr("src"),u.find("img").attr("src",o),u.find(".comment-authorname").text(f.data("fullname")),u.find(".comment-content").html(e),s=r.closest(".box-comments").find(".box-commentsection"),s.append(u.removeClass("d-none")))}function f(n){setTimeout(function(){n.style.cssText="height:auto;";n.style.cssText="height:"+(n.scrollHeight+2)+"px"},0)}var n={},t={};return{Init:e,AutosizeTextArea:f,BindShareContent:i}}();$(function(){CONTENTACTIONS.Init()});